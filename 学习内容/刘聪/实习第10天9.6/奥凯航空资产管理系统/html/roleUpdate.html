<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>角色修改</title>
    <script src="../../../实习第六天9.2/jQuery/jquery/实训案例--学院管理系统/layui/layui.js"></script>
    <link rel="stylesheet" href="../../../实习第六天9.2/jQuery/jquery/实训案例--学院管理系统/layui/css/layui.css">
    <link rel="stylesheet" href="../../../实习第六天9.2/jQuery/jquery/实训案例--学院管理系统/css/reset.css">
    <script src="../js/url.js"></script>
</head>
<body>
<div class="layui-fluid">
<div class="layui-card">
    <div class="layui-card-header">角色修改</div>
    <div class="layui-card-body">
        <div class="layui-form layui-form-pane" lay-filter="role">
            <input type="hidden" name="roleId">
            <div class="layui-row layui-col-space10">

                <div class="layui-col-xs6">
                    <div class="layui-form-item">
                        <lable class="layui-form-label" for="txt_roleId">
                            <span class="required">*</span>
                            角色编号
                        </lable>
                        <div class="layui-input-block">
                            <input type="text" placeholder="请输入角色编号" class="layui-input"
                                   name="roleId" id="txt_roleId" lay-verify="required">
                        </div>
                    </div>
                </div>

                <div class="layui-col-xs6">
                    <div class="layui-form-item">
                        <lable class="layui-form-label" for="txt_roleName">
                            <span class="required">*</span>
                            角色名
                        </lable>
                        <div class="layui-input-block">
                            <input type="text" placeholder="请输入角色名" class="layui-input"
                                   name="roleName" id="txt_roleName" lay-verify="required">
                        </div>
                    </div>
                </div>

                <div class="layui-col-xs6">
                    <div class="layui-form-item">
                        <lable class="layui-form-label" for="txt_code">
                            <span class="required">*</span>
                            码
                        </lable>
                        <div class="layui-input-block">
                            <input type="text" placeholder="请输入码" class="layui-input"
                                   name="code" id="txt_code" lay-verify="required">
                        </div>
                    </div>
                </div>

                <div class="layui-col-xs12">
                    <div class="layui-form-item layui-form-text">
                        <lable class="layui-form-label" for="txt_description">个人简介：</lable>
                        <div class="layui-input-block">
                            <textarea placeholder="个人简介(200字以内)" class="layui-textarea" name="description" id="txt_description"></textarea>
                        </div>
                    </div>
                </div>

                <div class="layui-col-xs2 layui-col-xs-offset8">
                    <button type="button" class="layui-btn layui-btn-normal layui-btn-fluid" id="btn_Return">
                        <i class="layui-icon layui-icon-close"></i>
                        返回
                    </button>
                </div>

                <div class="layui-col-xs2">
                    <button type="button" class="layui-btn layui-btn-fluid" lay-submit lay-filter="role" >
                        <i class="layui-icon layui-icon-ok"></i>
                        保存
                    </button>
                </div>


            </div>
        </div>
    </div>
</div>
</div>
<script >
    layui.use(['form','jquery','layer'],function () {
     var form=layui.form,
         $=layui.$,
         layer=parent===self?layui.layer:top.layui.layer;

        //
        $.get(
        'http://140.143.186.38:8088/api/Role',
            function (res) {
            form.render('select')
                var roleId = getUrl("id");
                $.get(
                    'http://140.143.186.38:8088/api/Role/'+roleId,
                    function (res) {
                        form.val('role', {
                            "roleId": res.data.roleId,
                            "roleName": res.data.roleName,
                            "code": res.data.code,
                            "description": res.data.description,
                        })
                    }
                )
            })
        //学员编辑表单提交
        form.on('submit(role)',function (object) {
            var data=object.field;
            $.ajax({
                url:'http://140.143.186.38:8088/api/Role',
                type:'PUT',
                data:data,
                success:function(res){
                    if(res.code===0){
                        layer.alert(res.data,{
                            icon:1,
                            title:'信息提示'
                        },function (alertIndex) {
                            layer.close(alertIndex);
                            closeIframweLayer();
                        })
                    } else{
                        layer.alert(res.msg,{
                            icon:3,
                            title:'错误提示'
                        })
                    }
                }
            })

            })
        var closeIframeLayer=function(){
            var iframLayerIndex=layer.getFrameIndex(window.name);
            layer.close(iframLayerIndex)
        }
        $('#btn_Return').click(function(){
            closeIframeLayer();
        })
            })
</script>
</body>
</html>